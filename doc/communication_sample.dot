digraph client_command_flow {
        label="Client Authentication";
        RequestAuthenticationInfo -> Authenticated [label=" authNecessary = false  "];
        RequestAuthenticationInfo -> "Password Prompt" [label=" authNecessary = true  "];
        "Password Prompt" -> Abort [label=" Cancel  "];
        "Password Prompt" -> RequestAuthentication [label=" OK  "];
        RequestAuthentication -> Authenticated [label=" success = true  "];
        RequestAuthentication -> "Password Prompt" [label=" success = false  "];
}

digraph handshake {
        "Authorization Necessary?" -> Done [label="No"];
        "Authorization Necessary?" -> "Send md5(password)" [label="Yes"];
        "Send md5(password)" -> "Session established" [label="Match"];
        "Send md5(password)" -> "Abort" [label="Mismatch"];
        "Receive (session key) XOR sha1(password)" -> Done [label="Decrypt"];
}